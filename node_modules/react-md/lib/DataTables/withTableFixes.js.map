{"version":3,"sources":["../../src/js/DataTables/withTableFixes.js"],"names":["withTableFixes","ComposedComponent","suffix","state","cellIndex","undefined","_fixedTo","props","fixedTo","id","isIndexed","isFixed","column","table","columns","slice","call","parentNode","querySelectorAll","setState","indexOf","forceUpdate","rowId","context","propid","propFixedTo","propCellIndex","Positions","HorizontalAnchors","VerticalAnchors","displayName","propTypes","oneOfType","number","string","contextTypes"],"mappings":";;;;;;;;;;kBAyBwBA,c;;AAzBxB;;;;AACA;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;;;;;AAEA;;;;;;;;;;;;;;;AAee,SAASA,cAAT,CAAwBC,iBAAxB,EAA2CC,MAA3C,EAAmD;AAAA;;AAChE;AAAA;;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA,kNAqBEC,KArBF,GAqBU,EAAEC,WAAWC,SAAb,EArBV,QA+CEC,QA/CF,GA+Ca,IA/Cb;AAAA;;AAAA;AAAA;AAAA,0CAuBsB;AAAA,qBACiB,KAAKC,KADtB;AAAA,YACVH,SADU,UACVA,SADU;AAAA,YACCI,OADD,UACCA,OADD;AAAA,YACUC,EADV,UACUA,EADV;;AAElB,YAAMC,YAAY,CAAC,CAACD,EAAF,IAAQL,cAAc,CAAtB,IAA2B,CAAC,CAACA,SAA/C;AACA,YAAMO,UAAUH,YAAY,IAAZ,IAAoB,CAAC,CAACA,OAAtC;AACA,YAAIE,aAAaC,OAAjB,EAA0B;AACxB;AACA;AACD;;AAED,YAAMC,SAAS,2BAAY,IAAZ,CAAf;AACA,YAAMC,QAAQ,yBAAUD,MAAV,CAAd;AACA,aAAKN,QAAL,GAAgB,2BAAYO,KAAZ,CAAhB;;AAEA;AACA;AACA,YAAI,CAACH,SAAL,EAAgB;AACd,cAAMI,UAAU,GAAGC,KAAH,CAASC,IAAT,CAAcJ,OAAOK,UAAP,CAAkBC,gBAAlB,CAAmC,OAAnC,CAAd,CAAhB;AACA,eAAKC,QAAL,CAAc,EAAEf,WAAWU,QAAQM,OAAR,CAAgBR,MAAhB,CAAb,EAAd,EAFc,CAEyC;AACxD,SAHD,MAGO,IAAI,KAAKN,QAAT,EAAmB;AACxB;AACA,eAAKe,WAAL;AACD;AACF;AA7CH;AAAA;AAAA,+BAiDW;AAAA,YACCC,KADD,GACW,KAAKC,OADhB,CACCD,KADD;;AAAA,sBASH,KAAKf,KATF;AAAA,YAIDiB,MAJC,WAILf,EAJK;AAAA,YAKIgB,WALJ,WAKLjB,OALK;AAAA,YAMMkB,aANN,WAMLtB,SANK;AAAA,YAQFG,KARE;;AAAA,YAWDE,EAXC,GAWM,KAAKF,KAXX,CAWDE,EAXC;;AAYP,YAAMD,UAAU,KAAKF,QAAL,KAAkB,IAAlB,IAA0BmB,WAA1B,GAAwCA,WAAxC,GAAsD,KAAKnB,QAA3E;AACA,YAAMF,YAAY,wBAAS,KAAKG,KAAd,EAAqB,KAAKJ,KAA1B,EAAiC,WAAjC,CAAlB;AACA,YAAI,CAACM,EAAL,EAAS;AACPA,eAAQa,KAAR,SAAiBlB,SAAjB,SAA8BF,MAA9B;AACD;;AAED,eAAO,8BAAC,iBAAD,eAAuBK,KAAvB,IAA8B,IAAIE,EAAlC,EAAsC,SAASD,OAA/C,IAAP;AACD;AApEH;;AAAA;AAAA,kCACSmB,SADT,GACqB1B,kBAAkB0B,SADvC,SAESC,iBAFT,GAE6B3B,kBAAkB2B,iBAF/C,SAGSC,eAHT,GAG2B5B,kBAAkB4B,eAH7C,SAISC,WAJT,GAIuB,8BAAe7B,iBAAf,EAAkC,YAAlC,CAJvB,SAKS8B,SALT,GAKqB;AACjBtB,QAAI,oBAAUuB,SAAV,CAAoB,CACtB,oBAAUC,MADY,EAEtB,oBAAUC,MAFY,CAApB,CADa;AAKjB9B,eAAW,oBAAU6B,MALJ;AAMjBzB;AANiB,GALrB,SAcS2B,YAdT,GAcwB;AACpBb,WAAO,oBAAUU,SAAV,CAAoB,CACzB,oBAAUC,MADe,EAEzB,oBAAUC,MAFe,CAApB;AADa,GAdxB;AAsED","file":"withTableFixes.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\n\nimport getField from '../utils/getField';\nimport fixedToShape from '../Helpers/fixedToShape';\nimport findTable from './findTable';\nimport findFixedTo from './findFixedTo';\nimport getDisplayName from '../utils/StringUtils/getDisplayName';\n\n/**\n * This is a utility HOC to fix the components that use the `Menu` component behind the scenes. This will\n * correctly add the `id` and `fixedTo` props if they are omitted from the child component's props.\n *\n * If the id prop is omitted, it will default to the `${rowId}-${cellIndex}-${suffix}` and when the\n * `fixedTo` prop is omitted, it will automatically set it to the responsive table wrapper so that\n * it will stay in viewport as expected.\n *\n * This component also attempts to find the `cellIndex` prop if it is not correctly cloned into the\n * component.\n *\n * @param {function|Class} ComposedComponent - the component to compose with the tooltip functionality.\n * @param {String} suffix - the id suffix to apply.\n * @return {Class} the ComposedComponent with some fixes applied.\n */\nexport default function withTableFixes(ComposedComponent, suffix) {\n  return class TableFixesComponent extends PureComponent {\n    static Positions = ComposedComponent.Positions;\n    static HorizontalAnchors = ComposedComponent.HorizontalAnchors;\n    static VerticalAnchors = ComposedComponent.VerticalAnchors;\n    static displayName = getDisplayName(ComposedComponent, 'TableFixes');\n    static propTypes = {\n      id: PropTypes.oneOfType([\n        PropTypes.number,\n        PropTypes.string,\n      ]),\n      cellIndex: PropTypes.number,\n      fixedTo: fixedToShape,\n    };\n\n    static contextTypes = {\n      rowId: PropTypes.oneOfType([\n        PropTypes.number,\n        PropTypes.string,\n      ]),\n    }\n\n    state = { cellIndex: undefined };\n\n    componentDidMount() {\n      const { cellIndex, fixedTo, id } = this.props;\n      const isIndexed = !!id || cellIndex === 0 || !!cellIndex;\n      const isFixed = fixedTo === null || !!fixedTo;\n      if (isIndexed && isFixed) {\n        // all is good\n        return;\n      }\n\n      const column = findDOMNode(this);\n      const table = findTable(column);\n      this._fixedTo = findFixedTo(table);\n\n      // If a developer creates their own component to wrap the component that uses a menu, the cellIndex prop\n      // might not be defined if they don't pass ...props\n      if (!isIndexed) {\n        const columns = [].slice.call(column.parentNode.querySelectorAll('th,td'));\n        this.setState({ cellIndex: columns.indexOf(column) }); // eslint-disable-line react/no-did-mount-set-state\n      } else if (this._fixedTo) {\n        // need to apply the _fixedTo for the select field\n        this.forceUpdate();\n      }\n    }\n\n    _fixedTo = null;\n\n    render() {\n      const { rowId } = this.context;\n      const {\n        /* eslint-disable no-unused-vars */\n        id: propid,\n        fixedTo: propFixedTo,\n        cellIndex: propCellIndex,\n        /* eslint-enable no-unused-vars */\n        ...props\n      } = this.props;\n\n      let { id } = this.props;\n      const fixedTo = this._fixedTo === null || propFixedTo ? propFixedTo : this._fixedTo;\n      const cellIndex = getField(this.props, this.state, 'cellIndex');\n      if (!id) {\n        id = `${rowId}-${cellIndex}-${suffix}`;\n      }\n\n      return <ComposedComponent {...props} id={id} fixedTo={fixedTo} />;\n    }\n  };\n}\n"]}